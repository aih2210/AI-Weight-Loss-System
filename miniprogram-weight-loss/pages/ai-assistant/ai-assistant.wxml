<!--pages/ai-assistant/ai-assistant.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
  <view class="status-bar">
    <view class="status-item">
      <text class="status-icon">{{useRealAI && apiKey ? 'ğŸ¤–' : 'ğŸ’¬'}}</text>
      <text class="status-text">{{useRealAI && apiKey ? 'é€šä¹‰åƒé—®AI' : 'æœ¬åœ°çŸ¥è¯†åº“'}}</text>
    </view>
    <view class="status-actions">
      <view class="status-btn" bindtap="showApiGuide">â“</view>
      <view class="status-btn" bindtap="setApiKey">âš™ï¸</view>
    </view>
  </view>

  <!-- èŠå¤©æ¶ˆæ¯åˆ—è¡¨ -->
  <view class="messages-container">
    <view class="message-item {{item.role === 'AI' ? 'ai-message' : 'user-message'}}" wx:for="{{messages}}" wx:key="id">
      <view class="message-avatar">
        {{item.role === 'AI' ? 'ğŸ¤–' : 'ğŸ‘¤'}}
      </view>
      <view class="message-content">
        <view class="message-text">{{item.content}}</view>
        <view class="message-time">{{item.time}}</view>
      </view>
    </view>
    
    <!-- æ­£åœ¨è¾“å…¥æç¤º -->
    <view wx:if="{{isTyping}}" class="typing-indicator">
      <view class="message-avatar">ğŸ¤–</view>
      <view class="typing-dots">
        <view class="dot"></view>
        <view class="dot"></view>
        <view class="dot"></view>
      </view>
    </view>
  </view>

  <!-- å¿«æ·é—®é¢˜ -->
  <view wx:if="{{messages.length <= 1}}" class="quick-questions">
    <view class="quick-title">ğŸ’¡ å¿«é€Ÿæé—®</view>
    <view class="quick-grid">
      <view class="quick-item" wx:for="{{quickQuestions}}" wx:key="index" bindtap="quickAsk" data-question="{{item}}">
        {{item}}
      </view>
    </view>
  </view>

  <!-- è¾“å…¥æ¡† -->
  <view class="input-container">
    <view class="input-box">
      <input class="message-input" placeholder="è¾“å…¥ä½ çš„é—®é¢˜..." value="{{inputText}}" bindinput="onInputChange" confirm-type="send" bindconfirm="sendMessage" disabled="{{isTyping}}" />
      <button class="send-button" bindtap="sendMessage" disabled="{{isTyping || !inputText}}">
        {{isTyping ? '...' : 'å‘é€'}}
      </button>
    </view>
    <view class="action-bar">
      <view class="action-item" bindtap="clearHistory">
        ğŸ—‘ï¸ æ¸…ç©ºè®°å½•
      </view>
      <view class="action-item" bindtap="toggleAIMode">
        ğŸ”„ {{useRealAI ? 'åˆ‡æ¢åˆ°æœ¬åœ°' : 'åˆ‡æ¢åˆ°AI'}}
      </view>
    </view>
  </view>
</view>
