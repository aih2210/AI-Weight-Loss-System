<!--pages/health-history/health-history.wxml-->
<view class="container">
  <!-- æ ‡ç­¾é¡µ -->
  <view class="tabs">
    <view 
      class="tab-item {{currentTab === index ? 'active' : ''}}" 
      wx:for="{{tabs}}" 
      wx:key="index"
      bindtap="switchTab"
      data-index="{{index}}">
      {{item}}
    </view>
  </view>

  <!-- æ—¥æœŸèŒƒå›´é€‰æ‹© -->
  <view class="date-range">
    <view 
      class="range-item {{dateRange === 7 ? 'active' : ''}}" 
      bindtap="changeDateRange"
      data-range="7">
      7å¤©
    </view>
    <view 
      class="range-item {{dateRange === 30 ? 'active' : ''}}" 
      bindtap="changeDateRange"
      data-range="30">
      30å¤©
    </view>
    <view 
      class="range-item {{dateRange === 90 ? 'active' : ''}}" 
      bindtap="changeDateRange"
      data-range="90">
      90å¤©
    </view>
  </view>

  <!-- æ­¥æ•°å†å² -->
  <view wx:if="{{currentTab === 0}}" class="history-content">
    <view class="card">
      <view class="card-title">ğŸ“Š æ­¥æ•°è¶‹åŠ¿</view>
      <view class="history-list">
        <view class="history-item {{item.status}}" wx:for="{{stepsHistory}}" wx:key="date">
          <view class="item-date">{{item.date}}</view>
          <view class="item-bar-container">
            <view class="item-bar" style="width: {{item.progress}}%"></view>
          </view>
          <view class="item-value">{{item.value}} æ­¥</view>
        </view>
      </view>
    </view>

    <view class="card stats-card">
      <view class="stat-row">
        <view class="stat-label">å¹³å‡æ­¥æ•°</view>
        <view class="stat-value">7,856 æ­¥</view>
      </view>
      <view class="stat-row">
        <view class="stat-label">æœ€é«˜è®°å½•</view>
        <view class="stat-value">12,345 æ­¥</view>
      </view>
      <view class="stat-row">
        <view class="stat-label">è¾¾æ ‡å¤©æ•°</view>
        <view class="stat-value">5 / 7 å¤©</view>
      </view>
    </view>
  </view>

  <!-- å¿ƒç‡å†å² -->
  <view wx:if="{{currentTab === 1}}" class="history-content">
    <view class="card">
      <view class="card-title">â¤ï¸ å¿ƒç‡è®°å½•</view>
      <view class="history-list">
        <view class="history-item {{item.status}}" wx:for="{{heartRateHistory}}" wx:key="date">
          <view class="item-date">{{item.date}}</view>
          <view class="item-value-large">{{item.value}} {{item.unit}}</view>
          <view class="item-status">{{item.status === 'success' ? 'æ­£å¸¸' : 'åé«˜'}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç¡çœ å†å² -->
  <view wx:if="{{currentTab === 2}}" class="history-content">
    <view class="card">
      <view class="card-title">ğŸ˜´ ç¡çœ è®°å½•</view>
      <view class="history-list">
        <view class="history-item {{item.status}}" wx:for="{{sleepHistory}}" wx:key="date">
          <view class="item-date">{{item.date}}</view>
          <view class="item-value-large">{{item.value}} {{item.unit}}</view>
          <view class="item-quality">è´¨é‡ï¼š{{item.quality}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- ä½“é‡å†å² -->
  <view wx:if="{{currentTab === 3}}" class="history-content">
    <view class="card">
      <view class="card-title">âš–ï¸ ä½“é‡å˜åŒ–</view>
      <view class="history-list">
        <view class="history-item" wx:for="{{weightHistory}}" wx:key="timestamp">
          <view class="item-date">{{item.date}}</view>
          <view class="item-value-large">{{item.weight}} kg</view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons">
    <button class="action-btn secondary" bindtap="exportData">
      ğŸ“¤ å¯¼å‡ºæ•°æ®
    </button>
    <button class="action-btn primary" bindtap="shareData">
      ğŸ“Š åˆ†äº«æŠ¥å‘Š
    </button>
  </view>
</view>
