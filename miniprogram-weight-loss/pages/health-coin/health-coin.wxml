<!--pages/health-coin/health-coin.wxml-->
<view class="container">
  <!-- ç­¾åˆ°åŠ¨ç”» -->
  <view wx:if="{{showCheckInAnimation}}" class="check-in-animation">
    <view class="coin-rain">
      <text class="coin">ğŸ’°</text>
      <text class="coin">ğŸ’°</text>
      <text class="coin">ğŸ’°</text>
      <text class="coin">ğŸ’°</text>
      <text class="coin">ğŸ’°</text>
    </view>
  </view>

  <!-- ä½™é¢å¡ç‰‡ -->
  <view class="balance-card">
    <view class="balance-header">
      <view class="balance-title">æˆ‘çš„å¥åº·å¸</view>
      <view class="rule-btn" bindtap="viewRules">è§„åˆ™</view>
    </view>
    <view class="balance-amount">
      <text class="coin-icon">ğŸ’°</text>
      <text class="amount">{{balance}}</text>
    </view>
    <view class="balance-stats">
      <view class="stat-item">
        <view class="stat-value">{{statistics.totalEarned}}</view>
        <view class="stat-label">ç´¯è®¡è·å¾—</view>
      </view>
      <view class="stat-item">
        <view class="stat-value">{{statistics.consecutiveDays}}</view>
        <view class="stat-label">è¿ç»­ç­¾åˆ°</view>
      </view>
      <view class="stat-item">
        <view class="stat-value">{{statistics.totalSpent}}</view>
        <view class="stat-label">ç´¯è®¡æ¶ˆè´¹</view>
      </view>
    </view>
  </view>

  <!-- æ¯æ—¥ä»»åŠ¡ -->
  <view class="section">
    <view class="section-title">ğŸ“‹ æ¯æ—¥ä»»åŠ¡</view>
    <view class="task-list">
      <view 
        class="task-item {{item.completed ? 'completed' : ''}}" 
        wx:for="{{dailyTasks}}" 
        wx:key="id"
        bindtap="viewTaskDetail"
        data-task="{{item}}">
        <view class="task-icon">{{item.icon}}</view>
        <view class="task-info">
          <view class="task-name">{{item.name}}</view>
          <view class="task-reward">+{{item.coins}} å¥åº·å¸</view>
        </view>
        <view class="task-status">
          <text wx:if="{{item.completed}}" class="status-done">âœ“</text>
          <text wx:else class="status-todo">â†’</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æœ€è¿‘è®°å½• -->
  <view class="section">
    <view class="section-header">
      <view class="section-title">ğŸ“Š æœ€è¿‘è®°å½•</view>
      <view class="view-all" bindtap="viewHistory">æŸ¥çœ‹å…¨éƒ¨ â†’</view>
    </view>
    <view class="history-list">
      <view class="history-item" wx:for="{{recentHistory}}" wx:key="timestamp">
        <view class="history-left">
          <view class="history-reason">{{item.reason}}</view>
          <view class="history-time">{{item.timestamp}}</view>
        </view>
        <view class="history-right">
          <view class="history-amount {{item.type}}">
            {{item.type === 'earn' ? '+' : '-'}}{{item.amount}}
          </view>
        </view>
      </view>
      <view wx:if="{{recentHistory.length === 0}}" class="empty-tip">
        æš‚æ— è®°å½•ï¼Œå¿«å»å®Œæˆä»»åŠ¡å§ï¼
      </view>
    </view>
  </view>

  <!-- å‰å¾€å•†åŸæŒ‰é’® -->
  <view class="mall-button" bindtap="goToMall">
    <view class="mall-icon">ğŸª</view>
    <view class="mall-text">
      <view class="mall-title">å¥åº·å•†åŸ</view>
      <view class="mall-desc">å¥åº·å¸+ç°é‡‘ï¼Œä¼˜æƒ è´­ä¹°åŒ»ç–—äº§å“</view>
    </view>
    <view class="mall-arrow">â†’</view>
  </view>
</view>
