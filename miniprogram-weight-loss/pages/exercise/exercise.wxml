<!--pages/exercise/exercise.wxml-->
<view class="container">
  <!-- цЩ║шГ╜ш┐РхКишобхИТхНбчЙЗ -->
  <view class="card plan-card" bindtap="goToExercisePlan">
    <view class="plan-header">
      <view class="plan-title">ЁЯПГ цЩ║шГ╜ш┐РхКишобхИТ</view>
      <view class="plan-arrow">тА║</view>
    </view>
    <view wx:if="{{hasActivePlan}}" class="plan-preview">
      <view class="plan-info">
        <view class="plan-stat">
          <view class="plan-stat-label">цЬмхСишонч╗Г</view>
          <view class="plan-stat-value">{{planStats.trainingDays}}хдй</view>
        </view>
        <view class="plan-stat">
          <view class="plan-stat-label">щвДцЬЯц╢ИшАЧ</view>
          <view class="plan-stat-value">{{planStats.totalCalories}}хНб</view>
        </view>
      </view>
      <view wx:if="{{todayPlan}}" class="today-plan">
        <view class="today-plan-label">ф╗КцЧешобхИТ</view>
        <view class="today-plan-content">{{todayPlan.focus}} ┬╖ {{todayPlan.totalTime}}хИЖщТЯ</view>
      </view>
    </view>
    <view wx:else class="plan-empty">
      <view class="plan-empty-text">ш┐Шц▓бцЬЙш┐РхКишобхИТя╝МчВ╣хЗ╗чФЯцИРф╕кцАзхМЦцЦ╣цбИ</view>
    </view>
  </view>

  <!-- ф╗КцЧеш┐РхКичЫоцаЗ -->
  <view class="card">
    <view class="card-title">ф╗КцЧеш┐РхКичЫоцаЗ</view>
    <view class="stats-grid">
      <view class="stat-box">
        <view class="stat-label">х╖▓хоМцИР</view>
        <view class="stat-value" style="color: #a8d08d;">{{todayExercise}}</view>
        <view class="stat-label">kcal</view>
      </view>
      <view class="stat-box">
        <view class="stat-label">чЫоцаЗ</view>
        <view class="stat-value">{{target}}</view>
        <view class="stat-label">kcal</view>
      </view>
      <view class="stat-box">
        <view class="stat-label">хоМцИРх║ж</view>
        <view class="stat-value" style="color: #ff9800;">{{progress}}%</view>
        <view class="stat-label">ч╗зч╗нхКац▓╣</view>
      </view>
    </view>
  </view>

  <!-- ф╗КцЧеш┐РхКишо░х╜Х -->
  <view class="card">
    <view class="card-title">ф╗КцЧеш┐РхКишо░х╜Х</view>
    <view wx:if="{{todayLogs.length > 0}}">
      <view class="exercise-item" wx:for="{{todayLogs}}" wx:key="id">
        <view class="exercise-header">
          <view class="exercise-name">{{item.type}}</view>
          <view class="exercise-calories">-{{item.calories}} kcal</view>
        </view>
        <view class="exercise-details">{{item.duration}}хИЖщТЯ</view>
        <view wx:if="{{item.notes}}" class="exercise-notes">{{item.notes}}</view>
      </view>
    </view>
    <view wx:else class="empty-text">
      ф╗Кхдйш┐Шц▓бцЬЙш┐РхКишо░х╜Х
    </view>
  </view>

  <!-- ц╖╗хКаш┐РхКицМЙщТо -->
  <button class="add-button" bindtap="showAddExercise">
    тЮХ ц╖╗хКаш┐РхКишо░х╜Х
  </button>
</view>

<!-- ц╖╗хКаш┐РхКих╝╣чкЧ -->
<view wx:if="{{showModal}}" class="modal" bindtap="hideModal">
  <view class="modal-content" catchtap="stopPropagation">
    <view class="modal-title">ц╖╗хКаш┐РхКишо░х╜Х</view>
    
    <view class="form-item">
      <view class="label">ш┐РхКич▒╗хЮЛ</view>
      <picker mode="selector" range="{{exerciseTypes}}" value="{{exerciseIndex}}" bindchange="onExerciseChange">
        <view class="picker-display">{{exerciseTypes[exerciseIndex]}}</view>
      </picker>
    </view>

    <view class="form-item">
      <view class="label">ш┐РхКицЧ╢щХ┐я╝ИхИЖщТЯя╝Й</view>
      <input class="input-field" type="digit" placeholder="шп╖ш╛УхЕеш┐РхКицЧ╢щХ┐" value="{{duration}}" bindinput="onDurationInput" />
    </view>

    <view class="form-item">
      <view class="label">ц╢ИшАЧхНбш╖пщЗМя╝ИшЗкхКишобчоЧя╝Й</view>
      <input class="input-field" type="digit" placeholder="шЗкхКишобчоЧ" value="{{calories}}" bindinput="onCaloriesInput" />
    </view>

    <view class="form-item">
      <view class="label">хдЗц│ия╝ИхПпщАЙя╝Й</view>
      <textarea class="textarea-field" placeholder="шо░х╜Хш┐РхКицДЯхПЧ..." value="{{notes}}" bindinput="onNotesInput" maxlength="200" />
    </view>

    <view class="button-group">
      <button class="cancel-button" bindtap="hideModal">хПЦц╢И</button>
      <button class="submit-button" bindtap="saveExerciseLog">ф┐ЭхнШ</button>
    </view>
  </view>
</view>
