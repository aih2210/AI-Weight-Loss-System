<!--pages/recipe-detail/recipe-detail.wxml-->
<view class="container" wx:if="{{recipe}}">
  <!-- å¤´éƒ¨ä¿¡æ¯ -->
  <view class="header-card">
    <view class="recipe-title">{{recipe.name}}</view>
    <view class="recipe-meta">
      <view class="meta-item">
        <view class="meta-icon">â±ï¸</view>
        <view class="meta-text">{{recipe.time}}åˆ†é’Ÿ</view>
      </view>
      <view class="meta-item">
        <view class="meta-icon">ğŸ‘¨â€ğŸ³</view>
        <view class="meta-text">{{recipe.difficulty}}</view>
      </view>
      <view class="meta-item">
        <view class="meta-icon">ğŸ½ï¸</view>
        <view class="meta-text">{{recipe.servings}}äººä»½</view>
      </view>
    </view>
    <view class="recipe-tags">
      <view class="tag" wx:for="{{recipe.tags}}" wx:key="*this">{{item}}</view>
    </view>
  </view>

  <!-- è¥å…»æ¦‚è§ˆ -->
  <view class="nutrition-overview">
    <view class="nutrition-item">
      <view class="nutrition-value">{{recipe.calories}}</view>
      <view class="nutrition-label">å¡è·¯é‡Œ</view>
      <view class="nutrition-unit">kcal</view>
    </view>
    <view class="nutrition-item">
      <view class="nutrition-value">{{recipe.protein}}</view>
      <view class="nutrition-label">è›‹ç™½è´¨</view>
      <view class="nutrition-unit">g</view>
    </view>
    <view class="nutrition-item">
      <view class="nutrition-value">{{recipe.carbs}}</view>
      <view class="nutrition-label">ç¢³æ°´</view>
      <view class="nutrition-unit">g</view>
    </view>
    <view class="nutrition-item">
      <view class="nutrition-value">{{recipe.fat}}</view>
      <view class="nutrition-label">è„‚è‚ª</view>
      <view class="nutrition-unit">g</view>
    </view>
  </view>

  <!-- æ ‡ç­¾é¡µåˆ‡æ¢ -->
  <view class="tabs">
    <view 
      class="tab-item {{currentTab === 0 ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-tab="0">
      ğŸ›’ é£Ÿææ¸…å•
    </view>
    <view 
      class="tab-item {{currentTab === 1 ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-tab="1">
      ğŸ‘¨â€ğŸ³ åˆ¶ä½œæ­¥éª¤
    </view>
    <view 
      class="tab-item {{currentTab === 2 ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-tab="2">
      ğŸ’¡ å°è´´å£«
    </view>
  </view>

  <!-- é£Ÿææ¸…å• -->
  <view class="tab-content" wx:if="{{currentTab === 0}}">
    <view class="card">
      <view class="card-title">ğŸ›’ æ‰€éœ€é£Ÿæ</view>
      <view class="ingredients-list">
        <view class="ingredient-item" wx:for="{{recipe.ingredients}}" wx:key="name">
          <view class="ingredient-checkbox">âœ“</view>
          <view class="ingredient-info">
            <view class="ingredient-name">{{item.name}}</view>
            <view class="ingredient-note" wx:if="{{item.note}}">{{item.note}}</view>
          </view>
          <view class="ingredient-amount">{{item.amount}}</view>
        </view>
      </view>
    </view>

    <button class="btn-primary" bindtap="startCooking">
      ğŸ”¥ å¼€å§‹çƒ¹é¥ª
    </button>
  </view>

  <!-- åˆ¶ä½œæ­¥éª¤ -->
  <view class="tab-content" wx:if="{{currentTab === 1}}">
    <view class="progress-bar">
      <view class="progress-text">
        å®Œæˆè¿›åº¦ï¼š{{completedSteps.length}}/{{recipe.steps.length}}
      </view>
      <view class="progress-track">
        <view 
          class="progress-fill" 
          style="width: {{(completedSteps.length / recipe.steps.length) * 100}}%">
        </view>
      </view>
    </view>

    <view class="steps-list">
      <view 
        class="step-item {{completedSteps.indexOf(index) > -1 ? 'completed' : ''}}" 
        wx:for="{{recipe.steps}}" 
        wx:key="step"
        bindtap="toggleStep"
        data-index="{{index}}">
        <view class="step-header">
          <view class="step-number">
            <view class="step-num-text">{{item.step}}</view>
            <view class="step-checkmark" wx:if="{{completedSteps.indexOf(index) > -1}}">âœ“</view>
          </view>
          <view class="step-title-wrapper">
            <view class="step-title">{{item.title}}</view>
            <view class="step-time">â±ï¸ {{item.time}}</view>
          </view>
        </view>
        <view class="step-content">{{item.content}}</view>
        <view class="step-tips" wx:if="{{item.tips}}">
          <view class="tips-icon">ğŸ’¡</view>
          <view class="tips-text">{{item.tips}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- å°è´´å£« -->
  <view class="tab-content" wx:if="{{currentTab === 2}}">
    <view class="card">
      <view class="card-title">ğŸ‘¨â€ğŸ³ çƒ¹é¥ªæŠ€å·§</view>
      <view class="tips-list">
        <view class="tip-item" wx:for="{{recipe.cookingTips}}" wx:key="*this">
          <view class="tip-bullet">â€¢</view>
          <view class="tip-text">{{item}}</view>
        </view>
      </view>
    </view>

    <view class="card">
      <view class="card-title">ğŸŒŸ è¥å…»äº®ç‚¹</view>
      <view class="highlights-list">
        <view class="highlight-item" wx:for="{{recipe.nutritionHighlights}}" wx:key="*this">
          <view class="highlight-icon">âœ“</view>
          <view class="highlight-text">{{item}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="bottom-actions">
    <button class="action-btn" bindtap="addToFavorites">
      <view class="btn-icon">â¤ï¸</view>
      <view class="btn-text">æ”¶è—</view>
    </button>
    <button class="action-btn" bindtap="shareRecipe">
      <view class="btn-icon">ğŸ“¤</view>
      <view class="btn-text">åˆ†äº«</view>
    </button>
    <button class="action-btn" bindtap="goBack">
      <view class="btn-icon">ğŸ”™</view>
      <view class="btn-text">è¿”å›</view>
    </button>
  </view>
</view>
