# ğŸ“ çœŸå®é¤é¦†æ•°æ®é›†æˆè¯´æ˜

## ğŸ¯ åŠŸèƒ½è¯´æ˜

èšé¤åŠ©æ‰‹ç°åœ¨æ”¯æŒä½¿ç”¨çœŸå®çš„é¤é¦†æ•°æ®å’Œåœ°å›¾å¯¼èˆªåŠŸèƒ½ï¼

---

## ğŸ—ºï¸ åœ°å›¾APIé›†æˆ

### 1. è…¾è®¯åœ°å›¾API

å¾®ä¿¡å°ç¨‹åºæ¨èä½¿ç”¨è…¾è®¯åœ°å›¾APIï¼ˆè…¾è®¯ä½ç½®æœåŠ¡ï¼‰ã€‚

#### ç”³è¯·æ­¥éª¤

1. **æ³¨å†Œè…¾è®¯ä½ç½®æœåŠ¡**
   - è®¿é—®ï¼šhttps://lbs.qq.com/
   - æ³¨å†Œè´¦å·å¹¶ç™»å½•

2. **åˆ›å»ºåº”ç”¨**
   - è¿›å…¥æ§åˆ¶å°
   - åˆ›å»ºæ–°åº”ç”¨
   - é€‰æ‹©"å¾®ä¿¡å°ç¨‹åº"ç±»å‹

3. **è·å–Key**
   - åœ¨åº”ç”¨ä¸­æ·»åŠ Key
   - è®°å½•ä¸‹Keyï¼ˆåç»­ä½¿ç”¨ï¼‰

4. **ä¸‹è½½SDK**
   - ä¸‹è½½å¾®ä¿¡å°ç¨‹åºJavaScript SDK
   - æ”¾å…¥é¡¹ç›®çš„`utils`ç›®å½•

---

## ğŸ“Š çœŸå®é¤é¦†æ•°æ®æ¥æº

### æ–¹å¼ä¸€ï¼šè…¾è®¯åœ°å›¾POIæœç´¢

ä½¿ç”¨è…¾è®¯åœ°å›¾APIæœç´¢é™„è¿‘é¤é¦†ï¼š

```javascript
// æœç´¢é™„è¿‘é¤é¦†
searchNearbyRestaurants() {
  const qqmapsdk = new QQMapWX({
    key: 'YOUR_KEY_HERE' // æ›¿æ¢ä¸ºä½ çš„Key
  });

  qqmapsdk.search({
    keyword: 'é¤å…',
    location: {
      latitude: this.data.location.latitude,
      longitude: this.data.location.longitude
    },
    radius: this.data.searchRadius * 1000, // è½¬æ¢ä¸ºç±³
    page_size: 20,
    success: (res) => {
      const restaurants = res.data.map(poi => ({
        id: poi.id,
        name: poi.title,
        address: poi.address,
        lat: poi.location.lat,
        lng: poi.location.lng,
        distance: poi._distance,
        type: this.categorizeRestaurant(poi.category),
        // ... å…¶ä»–æ•°æ®
      }));
      
      this.setData({ restaurants });
    }
  });
}
```

### æ–¹å¼äºŒï¼šå¤§ä¼—ç‚¹è¯„API

é›†æˆå¤§ä¼—ç‚¹è¯„å¼€æ”¾å¹³å°APIè·å–é¤é¦†æ•°æ®ã€‚

### æ–¹å¼ä¸‰ï¼šè‡ªå»ºæ•°æ®åº“

æ”¶é›†å¹¶ç»´æŠ¤æœ¬åœ°é¤é¦†æ•°æ®åº“ã€‚

---

## ğŸ§­ å¯¼èˆªåŠŸèƒ½å®ç°

### ä½¿ç”¨wx.openLocation

å¾®ä¿¡å°ç¨‹åºæä¾›äº†å†…ç½®çš„åœ°å›¾å¯¼èˆªåŠŸèƒ½ï¼š

```javascript
// æ‰“å¼€åœ°å›¾å¯¼èˆª
openMap(restaurant) {
  wx.openLocation({
    latitude: restaurant.lat,
    longitude: restaurant.lng,
    name: restaurant.name,
    address: restaurant.address,
    scale: 15
  });
}
```

### åŠŸèƒ½ç‰¹ç‚¹

- âœ… è‡ªåŠ¨æ‰“å¼€å¾®ä¿¡å†…ç½®åœ°å›¾
- âœ… æ˜¾ç¤ºé¤é¦†ä½ç½®æ ‡è®°
- âœ… æä¾›å¯¼èˆªè·¯çº¿è§„åˆ’
- âœ… æ”¯æŒå¤šç§å¯¼èˆªæ–¹å¼ï¼ˆæ­¥è¡Œã€é©¾è½¦ã€å…¬äº¤ï¼‰
- âœ… å®æ—¶è·¯å†µä¿¡æ¯

---

## ğŸ“ å®ç°æ­¥éª¤

### æ­¥éª¤1ï¼šç”³è¯·è…¾è®¯åœ°å›¾Key

1. è®¿é—® https://lbs.qq.com/
2. æ³¨å†Œå¹¶åˆ›å»ºåº”ç”¨
3. è·å–Key

### æ­¥éª¤2ï¼šä¸‹è½½SDK

```bash
# ä¸‹è½½è…¾è®¯åœ°å›¾å¾®ä¿¡å°ç¨‹åºSDK
# åœ°å€ï¼šhttps://lbs.qq.com/miniProgram/jsSdk/jsSdkGuide/jsSdkOverview
```

### æ­¥éª¤3ï¼šé…ç½®é¡¹ç›®

åœ¨`app.json`ä¸­æ·»åŠ æƒé™ï¼š

```json
{
  "permission": {
    "scope.userLocation": {
      "desc": "ä½ çš„ä½ç½®ä¿¡æ¯å°†ç”¨äºæœç´¢é™„è¿‘é¤é¦†"
    }
  }
}
```

### æ­¥éª¤4ï¼šé›†æˆSDK

```javascript
// utils/qqmap.js
const QQMapWX = require('./qqmap-wx-jssdk.js');

const qqmapsdk = new QQMapWX({
  key: 'YOUR_KEY_HERE'
});

module.exports = qqmapsdk;
```

### æ­¥éª¤5ï¼šä½¿ç”¨API

```javascript
// pages/dining-assistant/dining-assistant.js
const qqmapsdk = require('../../utils/qqmap.js');

// æœç´¢é™„è¿‘é¤é¦†
searchRealRestaurants() {
  qqmapsdk.search({
    keyword: 'é¤å…',
    location: this.data.location,
    radius: this.data.searchRadius * 1000,
    success: (res) => {
      this.processRestaurants(res.data);
    }
  });
}
```

---

## ğŸ¨ ç•Œé¢ä¼˜åŒ–

### é¤é¦†å¡ç‰‡æ˜¾ç¤º

```xml
<view class="restaurant-card">
  <view class="restaurant-header">
    <view class="restaurant-name">{{item.name}}</view>
    <view class="restaurant-distance">{{item.distance}}m</view>
  </view>
  
  <view class="restaurant-address">
    ğŸ“ {{item.address}}
  </view>
  
  <view class="restaurant-actions">
    <button bindtap="openMap" data-restaurant="{{item}}">
      ğŸ§­ å¯¼èˆª
    </button>
    <button bindtap="viewDetails" data-restaurant="{{item}}">
      æŸ¥çœ‹è¯¦æƒ…
    </button>
  </view>
</view>
```

---

## ğŸ’¡ ç¤ºä¾‹ä»£ç 

### å®Œæ•´çš„æœç´¢å’Œå¯¼èˆªå®ç°

```javascript
Page({
  data: {
    location: null,
    restaurants: [],
    qqmapsdk: null
  },

  onLoad() {
    // åˆå§‹åŒ–åœ°å›¾SDK
    this.data.qqmapsdk = new QQMapWX({
      key: 'YOUR_KEY_HERE'
    });
    
    // è·å–ä½ç½®
    this.getLocation();
  },

  // è·å–ä½ç½®
  getLocation() {
    wx.getLocation({
      type: 'gcj02',
      success: (res) => {
        this.setData({
          location: {
            latitude: res.latitude,
            longitude: res.longitude
          }
        });
        
        // æœç´¢é¤é¦†
        this.searchRestaurants();
      }
    });
  },

  // æœç´¢é¤é¦†
  searchRestaurants() {
    this.data.qqmapsdk.search({
      keyword: 'é¤å…',
      location: this.data.location,
      radius: 2000, // 2å…¬é‡Œ
      page_size: 20,
      success: (res) => {
        const restaurants = res.data.map(poi => ({
          id: poi.id,
          name: poi.title,
          address: poi.address,
          lat: poi.location.lat,
          lng: poi.location.lng,
          distance: poi._distance,
          category: poi.category
        }));
        
        this.setData({ restaurants });
      }
    });
  },

  // æ‰“å¼€å¯¼èˆª
  openMap(e) {
    const restaurant = e.currentTarget.dataset.restaurant;
    
    wx.openLocation({
      latitude: restaurant.lat,
      longitude: restaurant.lng,
      name: restaurant.name,
      address: restaurant.address,
      scale: 15
    });
  }
});
```

---

## ğŸ”’ æ³¨æ„äº‹é¡¹

### 1. APIé…é¢

- è…¾è®¯åœ°å›¾APIæœ‰å…è´¹é…é¢
- è¶…å‡ºé…é¢éœ€è¦ä»˜è´¹
- å»ºè®®åšå¥½ç¼“å­˜æœºåˆ¶

### 2. éšç§ä¿æŠ¤

- è·å–ä½ç½®éœ€è¦ç”¨æˆ·æˆæƒ
- ä¸è¦å­˜å‚¨ç”¨æˆ·ç²¾ç¡®ä½ç½®
- éµå®ˆéšç§æ”¿ç­–

### 3. æ€§èƒ½ä¼˜åŒ–

- ç¼“å­˜æœç´¢ç»“æœ
- é™åˆ¶æœç´¢é¢‘ç‡
- ä½¿ç”¨é˜²æŠ–å¤„ç†

### 4. é”™è¯¯å¤„ç†

- ä½ç½®è·å–å¤±è´¥
- APIè°ƒç”¨å¤±è´¥
- ç½‘ç»œå¼‚å¸¸

---

## ğŸ“± ç”¨æˆ·ä½“éªŒ

### å¯¼èˆªæµç¨‹

```
ç”¨æˆ·ç‚¹å‡»"å¯¼èˆª"æŒ‰é’®
â†’ è°ƒç”¨wx.openLocation
â†’ æ‰“å¼€å¾®ä¿¡å†…ç½®åœ°å›¾
â†’ æ˜¾ç¤ºé¤é¦†ä½ç½®
â†’ ç”¨æˆ·é€‰æ‹©å¯¼èˆªæ–¹å¼
â†’ å¼€å§‹å¯¼èˆª
```

### å¯¼èˆªæ–¹å¼

- ğŸš¶ æ­¥è¡Œå¯¼èˆª
- ğŸš— é©¾è½¦å¯¼èˆª
- ğŸšŒ å…¬äº¤å¯¼èˆª
- ğŸš´ éª‘è¡Œå¯¼èˆª

---

## ğŸ¯ ä¸‹ä¸€æ­¥

### å½“å‰å®ç°

ç›®å‰ä»£ç ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œæ–¹ä¾¿å¼€å‘å’Œæµ‹è¯•ã€‚

### å‡çº§åˆ°çœŸå®æ•°æ®

1. ç”³è¯·è…¾è®¯åœ°å›¾Key
2. ä¸‹è½½å¹¶é›†æˆSDK
3. æ›¿æ¢æœç´¢é€»è¾‘
4. æµ‹è¯•å¯¼èˆªåŠŸèƒ½

### é…ç½®æ–‡ä»¶

åˆ›å»ºé…ç½®æ–‡ä»¶å­˜å‚¨Keyï¼š

```javascript
// config/map.js
module.exports = {
  qqmapKey: 'YOUR_KEY_HERE'
};
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

### å®˜æ–¹æ–‡æ¡£

- è…¾è®¯ä½ç½®æœåŠ¡ï¼šhttps://lbs.qq.com/
- å¾®ä¿¡å°ç¨‹åºåœ°å›¾APIï¼šhttps://developers.weixin.qq.com/miniprogram/dev/api/location/wx.openLocation.html
- SDKæ–‡æ¡£ï¼šhttps://lbs.qq.com/miniProgram/jsSdk/jsSdkGuide/jsSdkOverview

### ç¤ºä¾‹é¡¹ç›®

- è…¾è®¯åœ°å›¾å°ç¨‹åºç¤ºä¾‹
- å¾®ä¿¡å®˜æ–¹Demo

---

**ğŸ’¡ æç¤º**ï¼šç”±äºéœ€è¦ç”³è¯·API Keyå’Œä¸‹è½½SDKï¼Œå»ºè®®å…ˆä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®è¿›è¡Œå¼€å‘ï¼ŒåŠŸèƒ½å®Œå–„åå†é›†æˆçœŸå®åœ°å›¾APIã€‚

**æ–‡æ¡£åˆ›å»ºæ—¶é—´**ï¼š2025å¹´12æœˆ27æ—¥
