# 📊 体重趋势预测系统

## 功能概述

基于能量平衡方程和代谢模型，预测未来7天的体重变化趋势，帮助用户动态调整减重计划。

## 🎯 核心功能

### 1. 体重趋势预测
- ✅ 预测未来7天每日体重
- ✅ 计算每日体重变化量
- ✅ 评估预测置信度
- ✅ 显示预测日期

### 2. 能量平衡分析
- ✅ 计算每日能量平衡
- ✅ 考虑代谢率变化
- ✅ 综合摄入和消耗
- ✅ 动态调整TDEE

### 3. 趋势建议
- ✅ 速度过快/过慢预警
- ✅ 饮食调整建议
- ✅ 运动优化方案
- ✅ 目标接近提醒

## 🔬 预测原理

### 能量平衡方程

```
体重变化 = (热量摄入 - TDEE - 运动消耗) / 7700 kcal

其中：
- 7700 kcal ≈ 1 kg 体重
- TDEE = BMR × 活动系数
- BMR 会随减重逐渐下降
```

### 预测流程

```
1. 分析历史数据
   ↓
2. 计算平均摄入和消耗
   ↓
3. 预测代谢率变化
   ↓
4. 逐日计算能量平衡
   ↓
5. 累积体重变化
   ↓
6. 生成7天预测
```

### 代谢率动态调整

```javascript
// 每天的BMR变化
bmrDecayRate = (predictedBMR - currentBMR) / 7

// 第N天的BMR
dayN_BMR = currentBMR + (bmrDecayRate × N)

// 第N天的TDEE
dayN_TDEE = dayN_BMR × activityFactor
```

## 📈 预测示例

### 场景1：正常减重

**输入数据：**
- 当前体重：70kg
- 平均摄入：1500 kcal/天
- 平均运动：300 kcal/天
- 当前BMR：1400 kcal
- 预测BMR：1360 kcal

**预测结果：**
```
第1天：69.9kg (-0.1kg) 置信度90%
第2天：69.8kg (-0.1kg) 置信度82%
第3天：69.7kg (-0.1kg) 置信度74%
第4天：69.6kg (-0.1kg) 置信度66%
第5天：69.5kg (-0.1kg) 置信度58%
第6天：69.4kg (-0.1kg) 置信度50%
第7天：69.3kg (-0.1kg) 置信度42%

总变化：-0.7kg
周减重率：-1.0%
```

**建议：**
- ✅ 减重速度理想
- ✅ 继续保持当前计划

### 场景2：减重过快

**输入数据：**
- 当前体重：70kg
- 平均摄入：1000 kcal/天
- 平均运动：500 kcal/天
- 当前BMR：1400 kcal
- 预测BMR：1300 kcal

**预测结果：**
```
第1天：69.7kg (-0.3kg) 置信度90%
第2天：69.4kg (-0.3kg) 置信度82%
第3天：69.1kg (-0.3kg) 置信度74%
第4天：68.8kg (-0.3kg) 置信度66%
第5天：68.5kg (-0.3kg) 置信度58%
第6天：68.2kg (-0.3kg) 置信度50%
第7天：67.9kg (-0.3kg) 置信度42%

总变化：-2.1kg
周减重率：-3.0%
```

**建议：**
- ⚠️ 减重速度过快
- 🍽️ 建议增加200-300 kcal摄入
- 💡 避免代谢率过度下降

### 场景3：体重上升

**输入数据：**
- 当前体重：70kg
- 平均摄入：2500 kcal/天
- 平均运动：100 kcal/天
- 当前BMR：1400 kcal
- 预测BMR：1420 kcal

**预测结果：**
```
第1天：70.1kg (+0.1kg) 置信度90%
第2天：70.2kg (+0.1kg) 置信度82%
第3天：70.3kg (+0.1kg) 置信度74%
第4天：70.4kg (+0.1kg) 置信度66%
第5天：70.5kg (+0.1kg) 置信度58%
第6天：70.6kg (+0.1kg) 置信度50%
第7天：70.7kg (+0.1kg) 置信度42%

总变化：+0.7kg
周增重率：+1.0%
```

**建议：**
- ⚠️ 预测体重上升
- 🍽️ 建议减少300-500 kcal摄入
- 🏃 建议增加运动量

## 🎯 置信度计算

### 影响因素

1. **预测天数**
   - 第1天：90%
   - 第2天：82%
   - 第3天：74%
   - ...
   - 第7天：42%

2. **历史数据量**
   - < 7天：× 0.6
   - 7-14天：× 0.8
   - 14-30天：× 0.9
   - > 30天：× 1.0

3. **数据质量**
   - 连续性
   - 准确性
   - 完整性

### 置信度等级

| 置信度 | 说明 | 可靠性 |
|--------|------|--------|
| 90%+ | 非常可靠 | ⭐⭐⭐⭐⭐ |
| 80-90% | 可靠 | ⭐⭐⭐⭐ |
| 70-80% | 较可靠 | ⭐⭐⭐ |
| 60-70% | 一般 | ⭐⭐ |
| <60% | 参考 | ⭐ |

## 💡 使用建议

### 1. 数据准确性

**提高预测准确性：**
- ✅ 每天记录体重
- ✅ 详细记录饮食
- ✅ 记录所有运动
- ✅ 保持数据连续性

**避免误差：**
- ❌ 不要漏记
- ❌ 不要估算
- ❌ 不要间断

### 2. 解读预测

**关注重点：**
- 📊 总体趋势（上升/下降）
- 📈 变化速度（快/慢）
- 🎯 是否符合目标
- 💡 调整建议

**不要过度关注：**
- ❌ 单日波动
- ❌ 小数点后两位
- ❌ 短期变化

### 3. 动态调整

**根据预测调整计划：**

**如果预测上升：**
1. 减少热量摄入200-300 kcal
2. 增加运动量
3. 检查饮食记录准确性

**如果预测下降过快：**
1. 增加热量摄入100-200 kcal
2. 适当减少运动强度
3. 保护基础代谢

**如果预测理想：**
1. 保持当前计划
2. 继续记录数据
3. 定期复查

### 4. 特殊情况

**预测可能不准的情况：**
- 🎉 节假日（饮食不规律）
- 🏥 生病期间
- 💊 服用影响代谢的药物
- 🏃 突然改变运动习惯
- 🍽️ 突然改变饮食结构

**应对方法：**
- 记录特殊情况
- 调整预测参数
- 增加观察频率
- 灵活调整计划

## 📊 预测假设

### 基本假设

1. **饮食稳定**
   - 假设未来7天饮食与过去14天平均值相同
   - 如果计划改变饮食，需要手动调整

2. **运动稳定**
   - 假设未来7天运动与过去14天平均值相同
   - 如果计划改变运动，需要手动调整

3. **代谢变化**
   - 基于机器学习模型预测代谢率变化
   - 考虑减重持续时间和强度

4. **线性变化**
   - 假设体重变化是线性的
   - 实际可能有波动

### 假设的局限性

**不考虑的因素：**
- 水分波动
- 肌肉增长
- 激素变化
- 压力影响
- 睡眠质量
- 肠道健康

**改进方向：**
- 增加更多特征
- 考虑非线性因素
- 个性化模型训练
- 实时反馈调整

## 🎨 界面说明

### 趋势摘要

显示关键信息：
- 当前体重
- 预测体重
- 预计变化
- 变化率

### 每日预测

详细列表：
- 第N天
- 日期
- 预测体重
- 单日变化
- 置信度

### 预测假设

显示计算依据：
- 平均摄入
- 平均运动
- 起始BMR
- 预测BMR

### 趋势建议

个性化建议：
- 速度调整
- 饮食建议
- 运动建议
- 目标提醒

## 🔄 更新频率

### 建议频率

- **每天查看**：了解当天预测
- **每周分析**：评估整体趋势
- **调整后查看**：验证调整效果
- **异常时查看**：排查问题原因

### 数据更新

- 体重记录后自动更新
- 饮食记录后自动更新
- 运动记录后自动更新
- 手动刷新立即更新

## 📈 成功案例

### 案例1：稳定减重

**用户A：**
- 初始：75kg
- 目标：65kg
- 策略：每天1600 kcal + 300 kcal运动

**结果：**
- 预测准确率：85%
- 8周减重：8.5kg
- 成功达成目标

**关键：**
- 严格记录数据
- 根据预测调整
- 保持计划稳定

### 案例2：突破平台期

**用户B：**
- 平台期：3周体重不变
- 预测：继续当前计划体重不会下降

**调整：**
- 减少摄入200 kcal
- 增加HIIT训练
- 调整碳水比例

**结果：**
- 2周后突破平台期
- 继续稳定减重

## 🎯 最佳实践

1. **准确记录**
   - 每天同一时间称重
   - 详细记录所有饮食
   - 记录所有运动

2. **定期查看**
   - 每周查看预测
   - 对比实际和预测
   - 分析偏差原因

3. **灵活调整**
   - 根据预测调整计划
   - 不要过度调整
   - 给身体适应时间

4. **长期坚持**
   - 关注趋势不是单日
   - 保持耐心
   - 相信科学

---

**使用体重趋势预测，科学管理减重进程！** 🚀
