# 🍽️ 聚餐助手功能说明

## 📋 功能概述

聚餐助手是一个基于位置服务的智能餐厅推荐和饮食管理系统，帮助用户在外出就餐时做出健康选择。

---

## ✨ 核心功能

### 1. 📍 位置服务

#### 功能说明
- 获取用户当前位置
- 显示经纬度坐标
- 支持地图导航

#### 使用方法
1. 点击"获取位置"按钮
2. 允许小程序访问位置信息
3. 系统自动获取当前位置

#### 隐私说明
- 位置信息仅用于餐厅推荐
- 不会上传到服务器
- 可随时关闭位置权限

---

### 2. 🔍 智能餐厅推荐

#### 推荐算法

系统基于多维度评分推荐餐厅：

**评分维度**（总分100分）：
- **健康分数**（40分）- 餐厅的健康指数
- **距离分数**（30分）- 距离越近分数越高
- **卡路里匹配**（20分）- 与剩余预算的匹配度
- **用户评分**（10分）- 餐厅评分

**推荐理由**：
- 健康指数高（≥85分）
- 距离近（<1km）
- 低卡路里（<600卡）
- 评分高（≥4.5星）

#### 餐厅信息

每个餐厅显示：
- 📍 距离（km）
- ⭐ 评分（1-5星）
- 🔥 平均卡路里
- 🏷️ 标签（低卡、高蛋白等）
- 📊 健康指数（0-100分）

#### 餐厅类型

系统内置6种餐厅类型：

1. **轻食沙拉馆**
   - 平均热量：400卡
   - 健康指数：95分
   - 特点：低卡、高蛋白、新鲜

2. **健康便当**
   - 平均热量：550卡
   - 健康指数：85分
   - 特点：营养均衡、便捷、实惠

3. **日式料理**
   - 平均热量：600卡
   - 健康指数：80分
   - 特点：精致、低油、海鲜

4. **蒸菜馆**
   - 平均热量：500卡
   - 健康指数：88分
   - 特点：清淡、少油、健康

5. **火锅店**
   - 平均热量：800卡
   - 健康指数：60分
   - 特点：社交、多样、高热量

6. **快餐店**
   - 平均热量：900卡
   - 健康指数：45分
   - 特点：快速、高热量、油炸

---

### 3. 💰 卡路里预算管理

#### 预算计算
```
剩余预算 = 每日目标 - 今日已摄入
```

#### 预算状态

**充足（>300卡）**
- 显示绿色
- 可以正常选择餐厅

**紧张（100-300卡）**
- 显示橙色
- 建议选择低卡餐厅

**超支（≤0卡）**
- 显示红色
- 强烈建议选择低卡餐厅
- 推荐增加运动

---

### 4. 🍽️ 菜品推荐

#### 推荐逻辑
- 根据剩余预算筛选合适菜品
- 标记适合/不适合的菜品
- 显示详细营养信息

#### 菜品信息
- 菜品名称
- 卡路里
- 蛋白质（g）
- 碳水化合物（g）
- 脂肪（g）

#### 适合性标记
- ✅ 适合：卡路里 ≤ 剩余预算
- ⚠️ 不适合：卡路里 > 剩余预算

---

### 5. 📝 餐前建议

#### 建议内容

##### A. 餐前准备
1. 餐前30分钟喝一杯水
2. 如果很饿，可以先吃点水果垫底
3. 提前查看菜单，做好选择
4. 告诉自己吃到7-8分饱就停

##### B. 用餐建议（基于餐厅类型）

**火锅店**：
- 选择清汤锅底，避免麻辣锅底
- 多点蔬菜和菌菇类
- 肉类选择瘦肉，避免肥牛肥羊
- 少蘸酱料，可用醋和葱花代替
- ⚠️ 避免：麻辣锅底、肥牛、午餐肉、油条、芝麻酱

**快餐店**：
- 避免油炸食品
- 选择烤制而非炸制
- 不要点套餐，单点更健康
- 饮料选择无糖或水
- ⚠️ 避免：炸鸡、薯条、可乐、奶昔

**日式料理**：
- 刺身是很好的选择
- 寿司适量，注意米饭量
- 避免天妇罗等油炸类
- 味增汤可以增加饱腹感
- ⚠️ 避免：天妇罗、炸虾、甜味寿司

**其他餐厅**：
- 选择清淡烹饪方式
- 多吃蔬菜和蛋白质
- 控制主食量
- 细嚼慢咽，吃到7分饱

##### C. 推荐菜品
- 列出3个最适合的菜品
- 按卡路里从低到高排序
- 显示详细营养信息

---

### 6. 📊 餐后记录

#### 记录流程
1. 选择吃的菜品
2. 确认营养信息
3. 自动添加到饮食记录
4. 生成餐后建议

#### 记录内容
- 菜品名称
- 卡路里
- 蛋白质、碳水、脂肪
- 用餐时间
- 来源标记（dining-assistant）

---

### 7. 💡 餐后调整方案

#### 建议内容

##### A. 预算分析

**超支情况**（剩余<0）：
- ⚠️ 今日已超出预算
- 建议增加运动
- 晚餐选择清淡食物或减少分量
- 多喝水，促进代谢

**推荐运动**：
- 运动类型：快走
- 运动时长：根据超支卡路里计算
- 消耗目标：约等于超支卡路里

**预算紧张**（剩余<300）：
- 今日预算所剩不多
- 下一餐选择低卡食物
- 可以吃些蔬菜和水果

**预算充足**（剩余≥300）：
- ✅ 预算控制良好
- 继续保持健康饮食
- 适量运动更佳

##### B. 消化建议
1. 餐后不要立即坐下或躺下
2. 可以散步15-30分钟助消化
3. 2小时内避免剧烈运动
4. 多喝水促进代谢

##### C. 运动建议（超支时）
```
运动时长 = 超支卡路里 / 5（分钟）
```
例如：超支100卡 → 建议快走20分钟

---

## 🗺️ 地图导航

### 功能说明
- 点击"导航"按钮
- 打开微信地图
- 显示餐厅位置
- 提供路线规划

### 使用方法
1. 选择餐厅
2. 点击"导航"按钮
3. 在地图中查看位置
4. 选择导航方式（步行/驾车/公交）

---

## 📱 使用流程

### 完整流程

```
1. 打开聚餐助手
   ↓
2. 获取位置
   ↓
3. 选择用餐类型（早餐/午餐/晚餐/夜宵）
   ↓
4. 搜索附近餐厅
   ↓
5. 查看推荐餐厅列表
   ↓
6. 选择餐厅查看详情
   ↓
7. 查看推荐菜品
   ↓
8. 获取餐前建议
   ↓
9. 前往餐厅用餐
   ↓
10. 餐后记录摄入
    ↓
11. 查看餐后调整方案
    ↓
12. 执行建议（运动/调整下一餐）
```

---

## 🎯 使用场景

### 场景1：工作日午餐
**情况**：中午外出就餐，想吃得健康
**流程**：
1. 打开聚餐助手
2. 获取位置
3. 选择"午餐"
4. 查看附近健康餐厅
5. 选择"轻食沙拉馆"
6. 查看推荐菜品
7. 点"烤鸡胸沙拉"（380卡）
8. 餐后记录

### 场景2：朋友聚餐
**情况**：晚上和朋友吃火锅，担心热量超标
**流程**：
1. 打开聚餐助手
2. 选择"晚餐"
3. 找到"火锅店"
4. 查看餐前建议
5. 按建议选择清汤锅底
6. 多点蔬菜和瘦肉
7. 餐后记录
8. 查看超支情况
9. 按建议增加运动

### 场景3：预算紧张
**情况**：今日已摄入较多，剩余预算不足
**流程**：
1. 打开聚餐助手
2. 看到预算警告（红色）
3. 系统推荐低卡餐厅
4. 选择"蒸菜馆"
5. 点"清蒸鲈鱼套餐"（480卡）
6. 餐后散步30分钟

---

## 💡 健康贴士

### 聚餐6大原则
1. ✅ 餐前喝水增加饱腹感
2. ✅ 选择清淡烹饪方式
3. ✅ 多吃蔬菜和蛋白质
4. ✅ 控制主食和油脂
5. ✅ 细嚼慢咽，吃到7分饱
6. ✅ 餐后散步助消化

### 避免事项
- ❌ 空腹赴宴（容易暴饮暴食）
- ❌ 油炸食品
- ❌ 高糖饮料
- ❌ 过量饮酒
- ❌ 餐后立即坐下
- ❌ 吃到撑

### 聪明选择
- 🥗 沙拉 > 炒菜
- 🐟 清蒸 > 油炸
- 🍵 茶水 > 饮料
- 🥦 蔬菜 > 主食
- 🍗 瘦肉 > 肥肉
- 🍎 水果 > 甜点

---

## 🔧 技术实现

### 位置服务
```javascript
wx.getLocation({
  type: 'gcj02',
  success: (res) => {
    // 获取经纬度
    const { latitude, longitude } = res;
  }
})
```

### 餐厅评分算法
```javascript
score = 健康分数 × 0.4 
      + 距离分数 × 0.3 
      + 卡路里匹配 × 0.2 
      + 用户评分 × 0.1
```

### 地图导航
```javascript
wx.openLocation({
  latitude: 餐厅纬度,
  longitude: 餐厅经度,
  name: 餐厅名称,
  scale: 15
})
```

---

## 📊 数据结构

### 餐厅数据
```javascript
{
  id: 1,
  name: '轻食沙拉馆',
  type: '轻食',
  distance: 0.5,
  rating: 4.8,
  avgCalories: 400,
  healthScore: 95,
  tags: ['低卡', '高蛋白', '新鲜'],
  dishes: [...]
}
```

### 菜品数据
```javascript
{
  name: '烤鸡胸沙拉',
  calories: 380,
  protein: 45,
  carbs: 20,
  fat: 12
}
```

---

## 🚀 未来计划

### 功能增强
- [ ] 接入真实地图API（如腾讯地图）
- [ ] 接入真实餐厅数据（如美团、大众点评）
- [ ] 支持餐厅收藏
- [ ] 支持餐厅评价
- [ ] 添加餐厅照片
- [ ] 支持在线订餐

### AI增强
- [ ] 集成通义千问生成个性化建议
- [ ] 基于历史记录推荐餐厅
- [ ] 智能预测用餐热量
- [ ] 自动识别菜品照片

### 社交功能
- [ ] 分享餐厅给好友
- [ ] 查看好友推荐
- [ ] 组队聚餐
- [ ] 餐厅打卡

---

## 🔒 隐私与权限

### 所需权限
- **位置权限**：用于搜索附近餐厅
- **地图权限**：用于导航

### 隐私保护
- ✅ 位置信息仅用于本地计算
- ✅ 不会上传到服务器
- ✅ 可随时关闭权限
- ✅ 所有数据本地存储

### 权限管理
```json
"permission": {
  "scope.userLocation": {
    "desc": "你的位置信息将用于提供更好的服务"
  }
}
```

---

## 📝 更新日志

### v4.1 - 聚餐助手 (2025-12-27)
- ✅ 新增位置服务
- ✅ 新增智能餐厅推荐
- ✅ 新增卡路里预算管理
- ✅ 新增餐前建议系统
- ✅ 新增餐后调整方案
- ✅ 新增地图导航功能
- ✅ 内置6种餐厅类型
- ✅ 内置24种健康菜品

---

## 🎉 总结

聚餐助手帮助用户在外出就餐时：

1. **智能推荐** - 基于位置和预算推荐健康餐厅
2. **餐前指导** - 提供具体的用餐建议和菜品推荐
3. **餐后管理** - 记录摄入并提供调整方案
4. **便捷导航** - 一键打开地图导航到餐厅

让减重不再是孤独的战斗，即使聚餐也能吃得健康！
